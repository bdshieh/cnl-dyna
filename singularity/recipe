BootStrap: localimage
From: base.img

%runscript
	echo "This is what happens when you run the container..."	

%environment
	export PATH=/opt/conda/bin:$PATH

%files
	options.inc.default /opt/	

%post
	echo "Hello from inside the container"
	sed -i 's/$/ universe/' /etc/apt/sources.list
	apt-get update
	apt-get clean

	# install linux tools & prequisites
	apt-get install -y wget bzip2 git build-essential libblas-dev liblapack-dev gfortran
	
	# install and setup miniconda python
#	wget --quiet https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/anaconda.sh
#	/bin/bash ~/anaconda.sh -b -p /opt/conda
#	rm ~/anaconda.sh 
#	export PATH=/opt/conda/bin:$PATH
#	conda init bash
#	echo "conda activate cnl-dyna" >> ~/.bashrc
	
#	conda create -n cnl-dyna 	
#	. activate cnl-dyna
#	conda install -y -c conda-forge numpy scipy matplotlib
        
	# install cnl-dyna
	cd /opt/ && git clone https://github.com/bdshieh/cnl-dyna.git && cd /opt/cnl-dyna
	
	# install H2Lib
	cd /opt/ && git clone https://github.com/H2Lib/H2Lib.git && cd /opt/H2Lib
	git checkout community
	cp /opt/cnl-dyna/singularity/options.inc.default /opt/H2Lib/
	make

